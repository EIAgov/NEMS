!  $Header: m:/default/includes/RCS/cogen,v 1.17 2017/05/19 19:28:38 rsc Exp $
!  COGENERATION COMMON BLOCK
!  The dimension parameters are &6005PRJ.NEMS.COMMON.PDS.datecode:PARAMETR
!  the user should add the following INCLUDE statement
!     include 'parametr'
!     include 'emmparm'
!   Cogeneration output variables
!
!   THE ARRAYS ARE INDEXED BY (MNUMCR,MNUMYR,FUEL,GRID/SELF,VINTAGE)
!   EXCEPT FOR THE OUTPUT FROM OTHER SOURCE AND COMMERCIAL COGEN
!   WHERE THE GRID/OWN USE SPLIT IS REPRESENTED IN A SEPARATE
!   VARIABLE
!    MNUMCR      = 9 CENSUS Divisions
!    MNUMNR      = 16 NERC REGIONS
!    MNUMYR      = years - 1990 to 2015, 2020, 2025, 2030, 2050
!    MNUMCGF FUELS: 
!            1=Coal            2=Petroleum      3=Natural Gas     4=Hydropower
!            5=Geothermal      6=MSW            7=Biomass         8=Solar Photovoltaic
!            9=Other Gaseous  10=Other         11=Wind           12=Solar Thermal
!    FUEL = EOR = 4; 1=COAL;2=OIL;3=GAS;4=OTHER/RENEW;
!    NON-TRADITIONAL COGEN - UNPLANNED CAPACITY BY PRIME MOVER
!
!    GRID/SELF   = 2 options;1=electricity sold to utilities,
!                            2=electricity for own-use
!    VINTAGE     = 2 OPTIONS;1=EXISTING AND PLANNED; 2=UNPLANNED
!    (ONLY CAPACITY BY VINTAGE)
!
! Electric Power sector CHaP by own use/sales to grid
      REAL CGOTGEN(MNUMNR,MNUMYR,10) ! OTHER COGEN GENERATION
      REAL CGEPGEN(MNUMNR,MNUMYR,2)  ! 1 is Power Only, 2 is CHaP

! NON-TRADITIONAL COGENERATION EXISTING & PLANNED (FORM 867)
      REAL CGNTCAP(MNUMNR,MNUMYR,MNUMCGF) !NON-TRAD EXIST&PLANNED COGEN CAPACITY
      REAL CGNTGEN(MNUMNR,MNUMYR,MNUMCGF,2) !NON-TRAD EXIST&PLANNED COGEN GENERATION
      REAL CGNTQ(MNUMNR,MNUMYR,MNUMCGF) !NON-TRAD EXIST&PLANNED COGEN FUEL CONSUMPTION

! NON-TRADITIONAL COGENERATION - CAPACITY
      REAL UCAPCSC(MNUMNR,MNUMYR) !NON-TRAD COAL STEAM CAPACITY
      REAL UCAPIGC(MNUMNR,MNUMYR) !NON-TRAD ADVANCED COAL STEAM CAPACITY
      REAL UCAPOSC(MNUMNR,MNUMYR) !NON-TRAD OTHER STEAM CAPACITY
      REAL UCAPCCC(MNUMNR,MNUMYR) !NON-TRAD COMB CYCLE CAPACITY
      REAL UCAPACC(MNUMNR,MNUMYR) !NON-TRAD ADVANCED COMB CYCLE CAPACITY
      REAL UCAPCTC(MNUMNR,MNUMYR) !NON-TRAD COMBUSTION TURBINE CAP
      REAL UCAPATC(MNUMNR,MNUMYR) !NON-TRAD ADVANCED COMBUSTION TURBINE CAP
      REAL UCAPRNC(MNUMNR,MNUMYR) !NON-TRAD RENEWABLE CAPACITY
      REAL UCAPHYC(MNUMNR,MNUMYR) !NON-TRAD CONV. HYDRO CAPACITY
      REAL UCAPGEC(MNUMNR,MNUMYR) !NON-TRAD GEOTHERMAL CAPACITY
      REAL UCAPMSC(MNUMNR,MNUMYR) !NON-TRAD MSW CAPACITY
      REAL UCAPWDC(MNUMNR,MNUMYR) !NON-TRAD BIOMASS CAPACITY
      REAL UCAPSTC(MNUMNR,MNUMYR) !NON-TRAD SOLAR THERMAL CAPACITY
      REAL UCAPPVC(MNUMNR,MNUMYR) !NON-TRAD PHOTOVOLTAIC CAPACITY - Tilt Axis
      REAL UCAPPTC(MNUMNR,MNUMYR) !NON-TRAD PHOTOVOLTAIC CAPACITY - Fixed Axis
      REAL UCAPWNC(MNUMNR,MNUMYR) !NON-TRAD WIND CAPACITY
      REAL UCAPWFC(MNUMNR,MNUMYR) !NON-TRAD OFS WIND CAPACITY
      REAL UCAPWLC(MNUMNR,MNUMYR) !NON-TRAD ONS WIND CAPACITY
      REAL UCAPTLC(MNUMNR,MNUMYR) !NON-TRAD TOTAL CAPACITY
!
! NON-TRADITIONAL COGENERATION - PLANNED CAPACITY
      REAL UADDCSC(MNUMNR,MNUMYR) !NON-TRAD PLANNED COAL STEAM CAPACITY
      REAL UADDIGC(MNUMNR,MNUMYR) !NON-TRAD PLANNED ADVANCED COAL STEAM CAPACITY
      REAL UADDOSC(MNUMNR,MNUMYR) !NON-TRAD PLANNED OTHER STEAM CAPACITY
      REAL UADDCCC(MNUMNR,MNUMYR) !NON-TRAD PLANNED COMB CYCLE CAPACITY
      REAL UADDACC(MNUMNR,MNUMYR) !NON-TRAD PLANNED ADVANCED COMB CYCLE CAPACITY
      REAL UADDCTC(MNUMNR,MNUMYR) !NON-TRAD PLANNED COMBUSTION TURBINE CAP
      REAL UADDATC(MNUMNR,MNUMYR) !NON-TRAD PLANNED ADVANCED COMBUSTION TURBINE CAP
      REAL UADDRNC(MNUMNR,MNUMYR) !NON-TRAD PLANNED RENEWABLE CAPACITY
      REAL UADDHYC(MNUMNR,MNUMYR) !NON-TRAD PLANNED CONV. HYDRO CAPACITY
      REAL UADDGEC(MNUMNR,MNUMYR) !NON-TRAD PLANNED GEOTHERMAL CAPACITY
      REAL UADDMSC(MNUMNR,MNUMYR) !NON-TRAD PLANNED MSW CAPACITY
      REAL UADDWDC(MNUMNR,MNUMYR) !NON-TRAD PLANNED BIOMASS CAPACITY
      REAL UADDSTC(MNUMNR,MNUMYR) !NON-TRAD PLANNED SOLAR THERMAL CAPACITY
      REAL UADDPVC(MNUMNR,MNUMYR) !NON-TRAD PLANNED PHOTOVOLTAIC CAPACITY
      REAL UADDPTC(MNUMNR,MNUMYR) !NON-TRAD PLANNED PHOTOVOLTAIC CAPACITY - FIXED AXIS
      REAL UADDWNC(MNUMNR,MNUMYR) !NON-TRAD PLANNED WIND CAPACITY
      REAL UADDWLC(MNUMNR,MNUMYR) !NON-TRAD PLANNED WIND CAPACITY - LOW SPEED
      REAL UADDWFC(MNUMNR,MNUMYR) !NON-TRAD PLANNED OFS WIND CAPACITY	  
      REAL UADDTLC(MNUMNR,MNUMYR) !NON-TRAD PLANNED TOTAL CAPACITY
!
!  The following three expand refinery CHaP fuels from 5 to 10 to parallel IND, RES, COM
      REAL CGREFQ(MNUMCR,MNUMYR,MNUMCGF)
      REAL CGREFCAP(MNUMCR,MNUMYR,MNUMCGF)
      REAL CGREFGEN(MNUMCR,MNUMYR,MNUMCGF,2)
!
!   COGENERATION OUTPUT FROM ENHANCED OIL RECOVERY (EOR) FACILITIES
      REAL CGOGSQ(MNUMCR,MNUMYR,4)
      REAL CGOGSCAP(MNUMCR,MNUMYR,4)
      REAL CGOGSGEN(MNUMCR,MNUMYR,4,2)
!
!  TOTAL COGENERATION OUTPUT FROM THE INDUSTRIAL SECTOR
!  INCLUDING OUTPUT FROM REFINERIES AND EOR
      REAL CGINDLQ(MNUMCR,MNUMYR,MNUMCGF)
      REAL CGINDLCAP(MNUMCR,MNUMYR,MNUMCGF)
      REAL CGINDLGEN(MNUMCR,MNUMYR,MNUMCGF,2)
!
!  Commercial variables:
      REAL CGCOMMQ (MNUMCR,MNUMYR,MNUMCGF)
      REAL CGCOMMCAP(MNUMCR,MNUMYR,MNUMCGF)
      REAL CGCOMMGEN(MNUMCR,MNUMYR,MNUMCGF,2)

!  Residential variables:
      REAL CGRESQ(MNUMCR,MNUMYR,MNUMCGF)     ! NONUTIL CONSUMPTION TRILLS
      REAL CGRESCAP(MNUMCR,MNUMYR,MNUMCGF)   ! NONUTIL CAPACITY MW
      REAL CGRESGEN(MNUMCR,MNUMYR,MNUMCGF,2) ! NONUTIL GENERATION OF ELEC GWH

! for NERC regions:
      REAL CGTOTQNR(MNUMNR,MNUMYR,MNUMCGF)
      REAL CGTOTCAPNR(MNUMNR,MNUMYR,MNUMCGF)
      REAL CGTOTGENNR(MNUMNR,MNUMYR,MNUMCGF,2)

! hydrogen sector:
      REAL CGHMMQ(MNUMCR,MNUMYR,5)           ! consumption in trillion Btu
      REAL CGHMMCAP(MNUMCR,MNUMYR,5)         ! capacity in megawatts
      REAL CGHMMGEN(MNUMCR,MNUMYR,5,2)       ! electricity generation in gigawatthours

! RPS Credit Amounts / kwh for Bingaman, Markey, etc.
      REAL CGCPVRES(MNUMCR,MNUMYR)           ! Residential RPS Credit / kwh for PV (scalar)
      REAL CGCWNRES(MNUMCR,MNUMYR)           ! Residential RPS Credit / kwh for Wind (scalar)
      REAL CGCPVCOM(MNUMCR,MNUMYR)           ! Commercial  RPS Credit / kwh for PV (scalar)
      REAL CGCWNCOM(MNUMCR,MNUMYR)           ! Commercial  RPS Credit / kwh for Wind (scalar)

! CES Credit Amounts for New Bingaman
      REAL ICHPCESGEN(MNUMCR,MNUMYR)         ! Industrial CES Credits (kwh)
      REAL OCHPCESGEN(MNUMCR,MNUMYR)         ! Refinery   CES Credits (kwh)
      REAL KCHPCESGEN(MNUMCR,MNUMYR)         ! Commercial CES Credits (kwh)
      REAL RCHPCESGEN(MNUMCR,MNUMYR)         ! Residential CES Credits (kwh)

! Average fossil-fuel heat rate
      REAL WHRFOSS(MNUMCR,MNUMYR)            ! Average fossil fuel heat rate

!   Cogeneration output common block
      COMMON/COGEN/ CGOTGEN,CGNTCAP,CGNTGEN,CGNTQ, &
       UCAPCSC,UCAPIGC,UCAPOSC,UCAPCCC,UCAPACC,UCAPCTC,UCAPATC, &
       UCAPRNC,UCAPHYC,UCAPGEC,UCAPMSC, &
       UCAPWDC,UCAPSTC,UCAPPVC,UCAPWNC,UCAPWFC,UCAPTLC, &
       UADDCSC,UADDIGC,UADDOSC,UADDCCC,UADDACC,UADDCTC,UADDATC, &
       UADDRNC,UADDHYC,UADDGEC,UADDMSC, &
       UADDWDC,UADDSTC,UADDPVC,UADDWNC,UADDWFC,UADDTLC, &	   
       CGRESGEN,CGRESQ,CGRESCAP, &
       CGREFQ, CGREFCAP, CGREFGEN, &
       CGOGSQ, CGOGSCAP, CGOGSGEN, &
       CGINDLQ, CGINDLCAP, CGINDLGEN, &
       CGCOMMQ, CGCOMMCAP, CGCOMMGEN, &
       CGTOTQNR, CGTOTCAPNR, CGTOTGENNR, &
       CGEPGEN, CGHMMQ, CGHMMCAP, CGHMMGEN, &
       CGCPVRES,CGCWNRES,CGCPVCOM,CGCWNCOM, &
       ICHPCESGEN,OCHPCESGEN,KCHPCESGEN,RCHPCESGEN, &
       WHRFOSS,UCAPWLC,UCAPPTC,UADDWLC,UADDPTC

!   Equivalence for FILER used for data storage
      REAL EQ_CGOUT(MNUMNR*MNUMYR*10 +    & ! CGOTGEN
           MNUMNR*MNUMYR*2 +              & ! CGEPGEN
           MNUMNR*MNUMYR*MNUMCGF +        & ! CGNTCAP
           MNUMNR*MNUMYR*MNUMCGF*2 +      & ! CGNTGEN
           MNUMNR*MNUMYR*MNUMCGF +        & ! CGNTQ
           MNUMNR*MNUMYR +                & ! UCAPCSC
           MNUMNR*MNUMYR +                & ! UCAPIGC
           MNUMNR*MNUMYR +                & ! UCAPOSC
           MNUMNR*MNUMYR +                & ! UCAPCCC
           MNUMNR*MNUMYR +                & ! UCAPACC
           MNUMNR*MNUMYR +                & ! UCAPCTC
           MNUMNR*MNUMYR +                & ! UCAPATC
           MNUMNR*MNUMYR +                & ! UCAPRNC
           MNUMNR*MNUMYR +                & ! UCAPHYC
           MNUMNR*MNUMYR +                & ! UCAPGEC
           MNUMNR*MNUMYR +                & ! UCAPMSC
           MNUMNR*MNUMYR +                & ! UCAPWDC
           MNUMNR*MNUMYR +                & ! UCAPSTC
           MNUMNR*MNUMYR +                & ! UCAPPVC
           MNUMNR*MNUMYR +                & ! UCAPPTC
           MNUMNR*MNUMYR +                & ! UCAPWNC
           MNUMNR*MNUMYR +                & ! UCAPWFC
           MNUMNR*MNUMYR +                & ! UCAPWLC
           MNUMNR*MNUMYR +                & ! UCAPTLC
           MNUMNR*MNUMYR +                & ! UADDCSC
           MNUMNR*MNUMYR +                & ! UADDIGC
           MNUMNR*MNUMYR +                & ! UADDOSC
           MNUMNR*MNUMYR +                & ! UADDCCC
           MNUMNR*MNUMYR +                & ! UADDACC
           MNUMNR*MNUMYR +                & ! UADDCTC
           MNUMNR*MNUMYR +                & ! UADDATC
           MNUMNR*MNUMYR +                & ! UADDRNC
           MNUMNR*MNUMYR +                & ! UADDHYC
           MNUMNR*MNUMYR +                & ! UADDGEC
           MNUMNR*MNUMYR +                & ! UADDMSC
           MNUMNR*MNUMYR +                & ! UADDWDC
           MNUMNR*MNUMYR +                & ! UADDSTC
           MNUMNR*MNUMYR +                & ! UADDPVC
           MNUMNR*MNUMYR +                & ! UADDPTC
           MNUMNR*MNUMYR +                & ! UADDWNC
           MNUMNR*MNUMYR +                & ! UADDWFC
           MNUMNR*MNUMYR +                & ! UADDWLC
           MNUMNR*MNUMYR +                & ! UADDTLC
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGREFQ
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGREFCAP
           MNUMCR*MNUMYR*MNUMCGF*2 +      & ! CGREFGEN
           MNUMCR*MNUMYR*4 +              & ! CGOGSQ
           MNUMCR*MNUMYR*4 +              & ! CGOGSCAP
           MNUMCR*MNUMYR*4*2 +            & ! CGOGSGEN
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGINDLQ
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGINDLCAP
           MNUMCR*MNUMYR*MNUMCGF*2 +      & ! CGINDLGEN
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGCOMMQ
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGCOMMCAP
           MNUMCR*MNUMYR*MNUMCGF*2 +      & ! CGCOMMGEN
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGRESQ
           MNUMCR*MNUMYR*MNUMCGF +        & ! CGRESCAP
           MNUMCR*MNUMYR*MNUMCGF*2 +      & ! CGRESGEN
           MNUMNR*MNUMYR*MNUMCGF +        & ! CGTOTQNR
           MNUMNR*MNUMYR*MNUMCGF +        & ! CGTOTCAPNR
           MNUMNR*MNUMYR*MNUMCGF*2 +      & ! CGTOTGENNR
           MNUMCR*MNUMYR*5 +              & ! CGHMMQ
           MNUMCR*MNUMYR*5 +              & ! CGHMMCAP
           MNUMCR*MNUMYR*5*2 +            & ! CGHMMGEN 
           MNUMCR*MNUMYR +                & ! CGCPVRES
           MNUMCR*MNUMYR +                & ! CGCWNRES
           MNUMCR*MNUMYR +                & ! CGCPVCOM
           MNUMCR*MNUMYR +                & ! CGCWNCOM
           MNUMCR*MNUMYR +                & ! ICHPCESGEN
           MNUMCR*MNUMYR +                & ! OCHPCESGEN
           MNUMCR*MNUMYR +                & ! KCHPCESGEN
           MNUMCR*MNUMYR +                & ! RCHPCESGEN
           MNUMCR*MNUMYR +                & ! WHRFOSS
           0)                               ! to end formula
      EQUIVALENCE (EQ_CGOUT,CGOTGEN)
